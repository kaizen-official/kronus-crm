// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id                String   @id @default(auto()) @map("_id") @db.ObjectId
  email             String   @unique
  password          String
  firstName         String
  lastName          String
  phone             String?
  role              Role     @default(USER)
  isActive          Boolean  @default(true)
  profileImage      String?
  department        String?
  designation       String?
  resetPasswordToken String?
  resetPasswordExpire DateTime?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  
  // Relations
  createdLeads      Lead[]   @relation("LeadCreator")
  assignedLeads     Lead[]   @relation("LeadAssignee")
  activities        Activity[]
  
  @@map("users")
}

model Lead {
  id              String      @id @default(auto()) @map("_id") @db.ObjectId
  firstName       String
  lastName        String
  email           String
  phone           String
  company         String?
  position        String?
  source          LeadSource  @default(WEBSITE)
  status          LeadStatus  @default(NEW)
  priority        Priority    @default(MEDIUM)
  estimatedValue  Float?
  notes           String?
  address         String?
  city            String?
  state           String?
  country         String?
  zipCode         String?
  
  // Relations
  createdById     String      @db.ObjectId
  createdBy       User        @relation("LeadCreator", fields: [createdById], references: [id])
  assignedToId    String?     @db.ObjectId
  assignedTo      User?       @relation("LeadAssignee", fields: [assignedToId], references: [id])
  activities      Activity[]
  
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  
  @@map("leads")
}

model Activity {
  id          String       @id @default(auto()) @map("_id") @db.ObjectId
  type        ActivityType
  title       String
  description String?
  date        DateTime     @default(now())
  
  // Relations
  userId      String       @db.ObjectId
  user        User         @relation(fields: [userId], references: [id])
  leadId      String?      @db.ObjectId
  lead        Lead?        @relation(fields: [leadId], references: [id])
  
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  
  @@map("activities")
}

enum Role {
  SUPER_ADMIN
  ADMIN
  MANAGER
  USER
}

enum LeadSource {
  WEBSITE
  REFERRAL
  SOCIAL_MEDIA
  EMAIL_CAMPAIGN
  COLD_CALL
  EVENT
  PARTNER
  OTHER
}

enum LeadStatus {
  NEW
  CONTACTED
  QUALIFIED
  PROPOSAL
  NEGOTIATION
  WON
  LOST
  INACTIVE
}

enum Priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum ActivityType {
  CALL
  EMAIL
  MEETING
  NOTE
  TASK
  FOLLOW_UP
}
